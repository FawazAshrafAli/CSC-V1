{% extends "admin_base/base.html" %}
{% load static %}

{% block title_prefix %}CSC Center{% endblock title_prefix %}

{% block content %}

<div class="dashboard-content">
	<!-- Titlebar -->
	<div id="titlebar">
		<div class="row">
			<div class="col-md-12">
				<h2>CSC Centers</h2>
				<!-- Breadcrumbs -->
				<nav id="breadcrumbs">
					<ul>
						<li><a href="{% include "admin_components/home_link.html" %}">Home</a></li>						
						<li>CSC Center</li>
					</ul>
				</nav>
			</div>
		</div>
		{% include "admin_components/message.html" %}
	</div>

	<div class="row">
		<style>
            #pop-up-box {
                position:fixed;
                left: 50%;
                top: 50%;
                transform: translate(-50%, -50%);
                z-index: 999;                
                background: #f7f7f7;
                box-shadow: 0 0 5px;
                min-width: 320px;
            }

            #pop-up-box-heading {
                background-color: #fff;
                padding: 10px;
                margin: 0 0 10px 0;
            }

            .close-btn {
                position: absolute;
                top: 5px; 
                right: 5px;
                font-size: 24px;
                color: red;
                background-color: #fff;
                border: none;
                box-shadow: 0 0 1px #777;
                padding: 0 7px;        
            }

            .close-btn:hover {
                color: #fff;
                background-color: rgba(255, 0, 0, 0.485);
            }

            #pop-up-form {
                padding: 0 10px;
                padding-bottom: 5px;
            }

            #pop-up-form select {                
                min-height: 150px;                
            }

            #pop-up-btns {
                float: right;
                padding-bottom: 5px;
            }

            #pop-up-add-toggle {
                color: #fff;
                width: 75px;
                text-transform: uppercase;
                background: linear-gradient(to bottom, darkgreen, green, darkgreen);
                box-shadow: 0 0 5px #777;
                border: none;
            }

            #pop-up-add-toggle:hover {
                background: linear-gradient(to bottom, lime, green, darkgreen);
            }

            #pop-up-edit-toggle {
                display: none;
                color: #fff;
                width: 75px;
                text-transform: uppercase;
                background: linear-gradient(to bottom, coral, orange, coral);
                box-shadow: 0 0 5px #777;
                border: none;
            }

            #pop-up-edit-toggle:hover {
                background: linear-gradient(to bottom, yellow, orange, coral);
            }

            #pop-up-delete-toggle {
                display: none;
                color: #fff;
                width: 75px;
                text-transform: uppercase;
                background: linear-gradient(to bottom, darkred, red, darkred);
                box-shadow: 0 0 5px #777;
                border: none;
            }

            #pop-up-delete-toggle:hover {
                background: linear-gradient(to bottom, orange, red, darkred);
            }

            #pop-up-add-btn-div {
                display: flex;
                justify-content: space-between;
                align-items: center;
            }

            #pop-up-add-btn {
                color: #fff;
                text-transform: uppercase;
                background: linear-gradient(to bottom, darkgreen, green, darkgreen);
                border: none;
                margin-bottom: 5px;
            }

            #pop-up-add-btn:hover {
                background: linear-gradient(to bottom, lime, green, darkgreen);
            }

            #pop-up-cancel-btn {
                color: #fff;
                text-transform: uppercase;
                background: linear-gradient(to bottom, darkblue, blue, darkblue);
                border: none;
                margin-bottom: 5px;
            }

            #pop-up-cancel-btn:hover {
                background: linear-gradient(to bottom, steelblue, blue, darkblue);
            }
        </style>

        <!-- Pop Up Box Start -->
        <div id="pop-up-box">
            <h3 id="pop-up-box-heading">States</h3>
            <button class="close-btn" aria-label="Close" title="Close">&times;</button>
            <form id="pop-up-form">
                <select id="pop-up-dropdown" size=5>
                    
                </select>
                <div id="pop-up-functions">
                    <div id="pop-up-btns">
                        <button id="pop-up-add-toggle" type="button">Add</button>
                        <button id="pop-up-edit-toggle" type="button">Edit</button>
                        <button id="pop-up-delete-toggle" type="button">Delete</button>
                    </div>                    
                    <!-- <input type="text" name="name" placeholder="Name of State">
                    <div id="pop-up-add-btn-div">
                        <button id="pop-up-add-btn" type="button">Add State</button>
                        <button id="pop-up-cancel-btn" type="button">Cancel</button>
                    </div> -->
                </div>                
            </form>
        </div>
        <!-- Pop Up Box Start -->

		<div class="col-lg-9 col-md-8 padding-right-30">
            <div class="dashboard-list-box margin-top-0">
				<h4>CSC Centers</h4>
				<ul>
					{% for blog in blogs %}
					<li>				
						<div class="list-box-listing">
							<div class="list-box-listing-img" style="display: flex; flex-direction: column;">
								<a href="#"><img src={% if blog.image %} {{blog.image.url}} {% else %} "images/listing-item-01.jpg" {% endif %} alt=""></a>
								<button id="blog-status-btn-{{blog.slug}}" style="{% if blog.status == 'Published' %} background-color:green; {% else %} background-color: darkred; {% endif %} color: #fff; border: 0;">{{blog.status}}</button>
							</div>
							<div class="list-box-listing-content">
								<div class="inner">
									<h3><a href="{% url 'csc_admin:blog' blog.slug %}">{{blog.title}}</a></h3>
									<p>{{blog.summary}}</p>
								</div>
							</div>
						</div>
						<div class="buttons-to-right">
							
							<a href="#" id="toggle-change-blog-status-btn-{{blog.slug}}" class="button gray" {% if blog.status == 'Published' %} onclick="(e) => e.preventDefault(); toggleSetDraft(`{{blog.slug}}`, `{{blog.title}}`);"><i class="fas fa-file-alt"></i> Keep as Draft {% else %} onclick="(e) => e.preventDefault(); togglePublishBlog(`{{blog.slug}}`, `{{blog.title}}`);"><i class="fas fa-paper-plane"></i> Publish Blog {% endif %}</a>
														
							<a href="{% url 'csc_admin:update_blog' blog.slug %}" class="button gray"><i class="sl sl-icon-note"></i> Edit</a>
							<a href="#" class="button gray" onclick="(e) => e.preventDefault(); toggleBlogDeletion(`{{blog.slug}}`, `{{blog.title}}`);"><i class="sl sl-icon-close"></i> Delete</a>
						</div>
					</li>
					{% endfor %}
				</ul>
			</div>
        </div>
        <!-- Blog Posts / End -->
        <!-- Widgets -->
        <div class="col-lg-3 col-md-4">
            <div class="sidebar right">                
                <!-- Widget -->
                <div class="widget margin-top-40">
                    <h4>Geographic Details</h4>
                    <ul class="list-4 color">
                        <li><a href="#" id="toggle-state-pop-up">States</a></li>
                        <li><a href="#" id="toggle-district-pop-up">Districts</a></li>
                        <li><a href="#" id="toggle-block-pop-up">Blocks</a></li>
                    </ul>
                </div>

                <div class="widget margin-top-40">
                    <h4>CSC Details</h4>
                    <ul class="list-4 color">
                        <li><a href="#">CSC Name Type</a></li>
                        <li><a href="#">Keywords</a></li>
                    </ul>
                </div>
                <!-- Widget / End -->
                <!-- Widget / End-->
                <div class="clearfix"></div>
                <div class="margin-bottom-40"></div>
            </div>
        </div>
    </div>


		<!-- Copyrights -->
		<div class="col-md-12">
			<div class="copyrights">Â© 2021 CSCIndia. All Rights Reserved.| Powered by <a href="https://www.zentrix.in/" target="_blank">Zentrix Technologies</a></div>
		</div>
	</div>

</div>
{% endblock content %}

{% block scripts %}
<script>
    $(document).ready(() => {
        $('#toggle-state-pop-up').on('click', function (e) {
            e.preventDefault();
            $('#pop-up-box-heading').html('States');
            
            $.ajax({
                type:'get',
                url:'/admin/get_all_states/',
                dataType:'json',
                success: data => {                    
                    if (data.states && Array.isArray(data.states)) {
                        $('#pop-up-dropdown').html('');
                        data.states.forEach(state => {
                            let html = `<option value="${state.id}">${state.state}</option>`;
                            $('#pop-up-dropdown').append(html);
                        });
                    } else {
                        $('#pop-up-dropdown').html('');
                    };
                },
                error: (jqXHR, textStatus, errorThrow) => {
                    console.error("Error: ", textStatus, errorThrow);
                }
            });
        });

        $('#toggle-district-pop-up').on('click', function (e) {
            e.preventDefault();
            $('#pop-up-box-heading').html('Districts');
            
            $.ajax({
                type:'get',
                url:'/admin/get_all_districts/',
                dataType:'json',
                success: data => {                    
                    if (data.districts && Array.isArray(data.districts)) {
                        $('#pop-up-dropdown').html('');
                        data.districts.forEach(district => {
                            let html = `<option value="${district.id}">${district.district}</option>`;
                            $('#pop-up-dropdown').append(html);
                        });
                    } else {
                        $('#pop-up-dropdown').html('');
                    };
                },
                error: (jqXHR, textStatus, errorThrow) => {
                    console.error("Error: ", textStatus, errorThrow);
                }
            });
        });

        $('#toggle-block-pop-up').on('click', function (e) {
            e.preventDefault();
            $('#pop-up-box-heading').html('Blocks');

            $.ajax({
                type:'get',
                url:'/admin/get_all_blocks/',
                dataType:'json',
                success: data => {                    
                    if (data.blocks && Array.isArray(data.blocks)) {
                        $('#pop-up-dropdown').html('');
                        data.blocks.forEach(block => {
                            let html = `<option value="${block.id}">${block.block}</option>`;
                            $('#pop-up-dropdown').append(html);
                        });
                    } else {
                        $('#pop-up-dropdown').html('');
                    };
                },
                error: (jqXHR, textStatus, errorThrow) => {
                    console.error("Error: ", textStatus, errorThrow);
                }
            });
        });

        $('#pop-up-form').on('change', function() {
            $('#pop-up-edit-toggle').show();
            $('#pop-up-delete-toggle').show();
        });
    });
</script>
{% endblock scripts %}